/**
 * Bundled by jsDelivr using Rollup v2.79.2 and Terser v5.39.0.
 * Original file: /npm/@bokuweb/zstd-wasm@0.0.27/dist/web/index.web.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
var t,e=void 0!==e?e:{},n={};for(t in e)e.hasOwnProperty(t)&&(n[t]=e[t]);var r=e.printErr||console.warn.bind(console);for(t in n)n.hasOwnProperty(t)&&(e[t]=n[t]);var o,i=(t,e)=>{throw e};n=null,e.arguments&&e.arguments,e.thisProgram&&(thisProgram=e.thisProgram),e.quit&&(i=e.quit),"object"!=typeof WebAssembly&&p("no native wasm support detected");var s,a,c=!1;function u(){var t=o.buffer;e.HEAP8=new Int8Array(t),e.HEAPU8=a=new Uint8Array(t)}var f=[],l=[],h=[];var _=0,m=null;function p(t){var n;throw null===(n=e.onAbort)||void 0===n||n.call(e,t),r(t="Aborted("+t+")"),c=!0,t+=". Build with -sASSERTIONS for more info.",new WebAssembly.RuntimeError(t)}class y{constructor(t){this.name="ExitStatus",this.message=`Program terminated with exit(${t})`,this.status=t}}var d,g=t=>{for(;t.length>0;)t.shift()(e)},b=e.noExitRuntime||!0,S=0,w={},v=t=>{if(t instanceof y||"unwind"==t)return s;i(1,t)},D=()=>b||S>0,T=t=>{var n;s=t,D()||(null===(n=e.onExit)||void 0===n||n.call(e,t),c=!0),i(t,new y(t))},Z=(t,e)=>{s=t,T(t)},L=t=>{if(!c)try{t(),(()=>{if(!D())try{Z(s)}catch(t){v(t)}})()}catch(t){v(t)}},A=t=>{var e=(t-o.buffer.byteLength+65535)/65536|0;try{return o.grow(e),u(),1}catch(t){}},E={c:()=>p(""),b:()=>{b=!1,S=0},d:(t,e)=>{if(w[t]&&(clearTimeout(w[t].id),delete w[t]),!e)return 0;var n=setTimeout((()=>{delete w[t],L((()=>C(t,performance.now())))}),e);return w[t]={id:n,timeout_ms:e},0},e:t=>{var e,n,r=a.length,o=2147483648;if((t>>>=0)>o)return!1;for(var i=1;i<=4;i*=2){var s=r*(1+.2/i);s=Math.min(s,t+100663296);var c=Math.min(o,(e=Math.max(t,s),n=65536,Math.ceil(e/n)*n));if(A(c))return!0}return!1},a:T};e._ZSTD_isError=t=>(e._ZSTD_isError=d.h)(t),e._ZSTD_compressBound=t=>(e._ZSTD_compressBound=d.i)(t),e._ZSTD_createCCtx=()=>(e._ZSTD_createCCtx=d.j)(),e._ZSTD_freeCCtx=t=>(e._ZSTD_freeCCtx=d.k)(t),e._ZSTD_compress_usingDict=(t,n,r,o,i,s,a,c)=>(e._ZSTD_compress_usingDict=d.l)(t,n,r,o,i,s,a,c),e._ZSTD_compress=(t,n,r,o,i)=>(e._ZSTD_compress=d.m)(t,n,r,o,i),e._ZSTD_createDCtx=()=>(e._ZSTD_createDCtx=d.n)(),e._ZSTD_freeDCtx=t=>(e._ZSTD_freeDCtx=d.o)(t),e._ZSTD_getFrameContentSize=(t,n)=>(e._ZSTD_getFrameContentSize=d.p)(t,n),e._ZSTD_decompress_usingDict=(t,n,r,o,i,s,a)=>(e._ZSTD_decompress_usingDict=d.q)(t,n,r,o,i,s,a),e._ZSTD_decompress=(t,n,r,o)=>(e._ZSTD_decompress=d.r)(t,n,r,o),e._malloc=t=>(e._malloc=d.s)(t),e._free=t=>(e._free=d.t)(t);var x,C=(t,e)=>(C=d.v)(t,e);function R(){function t(){var t;x||(x=!0,e.calledRun=!0,c||(g(l),null===(t=e.onRuntimeInitialized)||void 0===t||t.call(e),function(){if(e.postRun)for("function"==typeof e.postRun&&(e.postRun=[e.postRun]);e.postRun.length;)t=e.postRun.shift(),h.unshift(t);var t;g(h)}()))}_>0||(!function(){if(e.preRun)for("function"==typeof e.preRun&&(e.preRun=[e.preRun]);e.preRun.length;)t=e.preRun.shift(),f.unshift(t);var t;g(f)}(),_>0||(e.setStatus?(e.setStatus("Running..."),setTimeout((()=>{setTimeout((()=>e.setStatus("")),1),t()}),1)):t()))}if(m=function t(){x||R(),x||(m=t)},e.run=R,e.preInit)for("function"==typeof e.preInit&&(e.preInit=[e.preInit]);e.preInit.length>0;)e.preInit.pop()();e.init=function(t){var n,i={a:E};function s(t,n){var r;return d=t.exports,o=d.f,u(),r=d.g,l.unshift(r),function(){var t;if(_--,null===(t=e.monitorRunDependencies)||void 0===t||t.call(e,_),0==_&&m){var n=m;m=null,n()}}(),d}function a(t){s(t.instance)}function c(e){return(n=t,fetch(n,{credentials:"same-origin"}).then((function(t){if(!t.ok)throw"failed to load wasm binary file at '"+n+"'";return t.arrayBuffer()}))).then((function(t){return WebAssembly.instantiate(t,i)})).then(e,(function(t){r("failed to asynchronously prepare wasm: "+t),p(t)}));var n}if(_++,null===(n=e.monitorRunDependencies)||void 0===n||n.call(e,_),e.instantiateWasm)try{return e.instantiateWasm(i,s)}catch(t){return r("Module.instantiateWasm callback failed with error: "+t),!1}return t&&t.byteLength>0?WebAssembly.instantiate(t,i).then(a,(function(t){r("wasm compile failed: "+t)})):"function"==typeof WebAssembly.instantiateStreaming&&"string"==typeof t&&"function"==typeof fetch?fetch(t,{credentials:"same-origin"}).then((function(t){return WebAssembly.instantiateStreaming(t,i).then(a,(function(t){return r("wasm streaming compile failed: "+t),r("falling back to ArrayBuffer instantiation"),c(a)}))})):c(a),{}};var P=function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function s(t){try{c(r.next(t))}catch(t){i(t)}}function a(t){try{c(r.throw(t))}catch(t){i(t)}}function c(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,a)}c((r=r.apply(t,e||[])).next())}))};const H=new Promise((t=>{e.onRuntimeInitialized=t})),z=t=>(0,e._ZSTD_isError)(t),U=(t,n={defaultHeapSize:1048576})=>{const r=e._malloc,o=r(t.byteLength);e.HEAP8.set(t,o);const i=((t,n)=>(0,e._ZSTD_getFrameContentSize)(t,n))(o,t.byteLength),s=-1===i?n.defaultHeapSize:i,a=e._free,c=r(s);try{const n=(0,e._ZSTD_decompress)(c,s,o,t.byteLength);if(z(n))throw new Error(`Failed to compress with code ${n}`);const r=new Uint8Array(e.HEAPU8.buffer,c,n).slice();return a(c,s),a(o,t.byteLength),r}catch(e){throw a(c,s),a(o,t.byteLength),e}},I=(t,n)=>{const r=(o=t.byteLength,(0,e._ZSTD_compressBound)(o));var o;const i=e._malloc,s=i(r),a=i(t.byteLength);e.HEAP8.set(t,a);const c=e._free;try{const o=(0,e._ZSTD_compress)(s,r,a,t.byteLength,null!=n?n:3);if(z(o))throw new Error(`Failed to compress with code ${o}`);const i=new Uint8Array(e.HEAPU8.buffer,s,o).slice();return c(s,r),c(a,t.byteLength),i}catch(e){throw c(s,r),c(a,t.byteLength),e}},W=()=>e._ZSTD_createDCtx(),F=t=>e._ZSTD_freeDCtx(t),B=(t,n,r,o={defaultHeapSize:1048576})=>{const i=e._malloc,s=i(n.byteLength);e.HEAP8.set(n,s);const a=i(r.byteLength);e.HEAP8.set(r,a);const c=((t,n)=>(0,e._ZSTD_getFrameContentSize)(t,n))(s,n.byteLength),u=-1===c?o.defaultHeapSize:c,f=e._free,l=i(u);try{const o=(0,e._ZSTD_decompress_usingDict)(t,l,u,s,n.byteLength,a,r.byteLength);if(z(o))throw new Error(`Failed to compress with code ${o}`);const i=new Uint8Array(e.HEAPU8.buffer,l,o).slice();return f(l,u),f(s,n.byteLength),f(a,r.byteLength),i}catch(t){throw f(l,u),f(s,n.byteLength),f(a,r.byteLength),t}},M=()=>e._ZSTD_createCCtx(),$=t=>e._ZSTD_freeCCtx(t),k=(t,n,r,o)=>{const i=(s=n.byteLength,(0,e._ZSTD_compressBound)(s));var s;const a=e._malloc,c=a(i),u=a(n.byteLength);e.HEAP8.set(n,u);const f=a(r.byteLength);e.HEAP8.set(r,f);const l=e._free;try{const s=(0,e._ZSTD_compress_usingDict)(t,c,i,u,n.byteLength,f,r.byteLength,null!=o?o:3);if(z(s))throw new Error(`Failed to compress with code ${s}`);const a=new Uint8Array(e.HEAPU8.buffer,c,s).slice();return l(c,i),l(u,n.byteLength),l(f,r.byteLength),a}catch(t){throw l(c,i),l(u,n.byteLength),l(f,r.byteLength),t}};var q=function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function s(t){try{c(r.next(t))}catch(t){i(t)}}function a(t){try{c(r.throw(t))}catch(t){i(t)}}function c(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,a)}c((r=r.apply(t,e||[])).next())}))};const O=t=>q(void 0,void 0,void 0,(function*(){const n=new URL("./zstd.wasm",import.meta.url).href;e.init(null!=t?t:n),yield P(void 0,void 0,void 0,(function*(){yield H}))}));export{I as compress,k as compressUsingDict,M as createCCtx,W as createDCtx,U as decompress,B as decompressUsingDict,$ as freeCCtx,F as freeDCtx,O as init};export default null;
//# sourceMappingURL=/sm/559d28c95f087e738f75945a4fe88efc8181ce6fbc8d19955fd198ed51903aef.map